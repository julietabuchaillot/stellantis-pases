<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Pase Digital</title>
  <style>
    body { font-family: Helvetica, sans-serif; background: #f0f4f8; padding: 20px; }
    .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
    li { margin: 5px 0; }
    #estado { margin-top: 15px; font-weight: bold; font-size: 1.2em; }
  </style>
</head>
<body>
  <div class="card">
    <h2>🎟️ Pase ID: {{ pase.id }}</h2>
    <p><strong>Rol:</strong> {{ pase.rol }}</p>
    <p><strong>Fecha autorizada:</strong> {{ pase.fecha }}</p>
    <ul>
      <li>📄 Documentación: {{ '✅' if pase.documentacion else '❌' }}</li>
      <li>🧯 Curso de inducción: {{ '✅' if pase.curso else '❌' }}</li>
      <li>🌱 Certif. Sustentabilidad: {{ '✅' if pase.certificado else '❌' }}</li>
      <li>🔐 Autorización interna: {{ '✅' if pase.autorizacion else '❌' }}</li>
      <li>📆 Cita previa: {{ '✅' if pase.cita else '❌' }}</li>
    </ul>
    <div id="estado">⌛ Esperando la revelación...</div>
  </div>

  <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
  <script>
    const socket = io();
    socket.on('resultado', (data) => {
      if(data.id === "{{ pase.id }}"){
        const estadoDiv = document.getElementById('estado');
        if(data.es_impostor){
          estadoDiv.textContent = "🚨 Sos un impostor. No podés ingresar.";
          estadoDiv.style.color = "red";
        } else if(data.puede_ingresar){
          estadoDiv.textContent = "✅ Estás autorizado a ingresar.";
          estadoDiv.style.color = "green";
        } else {
          estadoDiv.textContent = "❌ No cumplís los requisitos para ingresar.";
          estadoDiv.style.color = "orange";
        }
      }
    });
  </script>
</body>
</html>
